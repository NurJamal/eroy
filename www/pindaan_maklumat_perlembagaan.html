<!DOCTYPE html>
<html>


		<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"/>
		<link rel="stylesheet" href="css/bootstrap.min.css">
		<link rel="stylesheet" type="text/css" href="css/header.css" />
		<link rel="stylesheet" type="text/css" href="css/body.css" />
		<link rel="stylesheet" type="text/css" href="css/color_icon.css">
		<link rel="stylesheet" href="css/style.css" />	
		<link rel="stylesheet" type="text/css" href="css/jquery-confirm.css" />
		<link rel="stylesheet" href="css/jquery-confirm.less" />
		<link type="text/css" rel="stylesheet" href="css/waitMe.css">
		
		<div id="scrollTop" >
			<img src="img/up_arrow.png" class="scrolltop_arrow"/>		
		</div>		
		<div id="loadingLayer"></div>
	
		
		
		<!--Load to Local Later-->
		<!--<link href="http://code.jquery.com/ui/1.10.4/themes/ui-lightness/jquery-ui.css" rel="stylesheet">
		<script src="http://code.jquery.com/jquery-1.10.2.js"></script>
		<script src="http://code.jquery.com/ui/1.10.4/jquery-ui.js"></script>
    
		<!-- CSS file -->
		<link type="text/css" rel="stylesheet" href="js/jquery.qtip.css" />
</head>

	<body>
	<div id="transparent_layer" ></div>
	
	<!-- slide menu right -->
	<div id="navigation"></div>
	<!-- end of slide menu right -->
	
	<!-- header -->
	<div id="head">
		<img src="img/logo-atas.png" class="logo"/>
		<img src="img/menu-icon.png" class="toggle-slide-right menu_icon" align="right"/>
		<img src="img/back-icon.png" onclick="goBack()" class="back_icon" align="left"/>
	</div>	
	<!-- end of header -->
	
	<!-- header title -->
	<div class="content_title">
		<div class="input-group add-on search-box">
			<div class="input-group-btn">
				<h1 class="main_title">PINDAAN MAKLUMAT</h1>
			</div>
		</div>
	
	</div>
	<!-- end of header-title-->

	<div id="content">	
		<h5 id="_orange_title_imal">Nama Pertubuhan</h5>
		<h1 class="_dark_text_imal">PERSATUAN SELSA MALAYSIA</h1>
		
		<h5 id="_orange_title_imal">
		<div id="appendPerlembagaan" >
		</div >


		</h5>
		
		
		<div class="default_button_holder">
			<a href="pindaan_maklumat_pembayaran.html"><input class="default_button" type="button" value="TERUSKAN" id="btn_submit"></a>
		</div>
	</div>

	
	<!-- js for slide menu -->
	<script src="js/classie.js"></script>
	<script src="js/nav.js"></script>
	
	<!-- jquery js-->
	<script src="js/jquery.min.js"></script>
    <script src="js/bootstrap.min.js"></script>
	<script src="js/jquery-1.9.1.min.js" type="text/javascript" language="javascript"></script>
	<script src="js/jquery.xml2json.js" type="text/javascript" language="javascript"></script>

	<!-- Scroll To Top (Add tag a header for all page) Import js/internal/custom.js-->
	<script src="js/internal/custom.js" type="text/javascript" language="javascript"></script>

	<!-- alert box -->
	<script src="js/jquery-confirm.js"></script>
	<script src="js/jquery-confirm.min.js"></script>	
	
	<!--Loading Indicator -->
	<script src="js/waitMe.js"></script>

	<script type="text/javascript" src="js/jquery.qtip.js"></script>
	<!-- Optional: imagesLoaded script to better support images inside your tooltips -->
	<!--<script type="text/javascript" src="js/jquery.imagesloaded.pkg.min.js"></script>-->
	<script>
	// Create the tooltips only when document ready
	
	
		//$(document).ready(function() {
		 
		// });
		
		$("#appendPerlembagaan").delegate(".openToolTip", "click", function (){
		
		rewriteID();
		var currentSelectedId = $(this).attr('id');
		var arr = currentSelectedId.split('_');
		localStorage['selected_id_perlembagaan'] = $.trim("tr_"+arr[1]);
		var currentID = localStorage['selected_id_perlembagaan'];
		var lol = '<table width="220" height="30">';
		lol += '<tr align="center">';
		lol += '<td width="10px"></td>';
		lol += '<td width="40px"><img src="img/addbottom-icon.png" width="40px" height="45px"  onclick="addTop()"></td>';
		lol += '<td width="40px"><img src="img/addtop-icon.png" width="40px" height="45px" onclick="addBottom()"></td>';
		lol += '<td width="40px"><img src="img/add-icon.png" width="40px" height="45px" onclick="addFasal()"></td>';
		lol += '<td width="40px"><img src="img/pindaan-icon.png" width="40px" height="45px" onclick="editFasal()"></td>';
		lol += '</tr>';
		lol += '</table>';
		
		$('#'+currentSelectedId).qtip({
		overwrite: false, 
			content: {
				text: lol,
				button: false,
					
			},
			 style: {
				width: 260, 
				height: 63,
				classes: 'qtip-rounded'
			 },   
				
			show: {
			 //effect: function(offset) {
			//		$(this).slideDown(100); // "this" refers to the tooltip
			//	},
				event: 'click',
				solo: false,
				
		   
			},

			hide:'unfocus',
			events: {
				visible: function(event, api) {
					$('#transparent_layer').show();
					$("body").css("overflow-y", "hidden");
					$('#added_'+currentID).remove();
				},
				 hide: function(event, api) {
					$('#transparent_layer').hide();
					$("body").css("overflow-y", "visible");
				
				}
			},
			 position: {
				my: 'bottom left',
				at: 'top left'
			}
		});
	});
		
	//Get Fasal Template
	getFasal('appendPerlembagaan', '1');

	//Add Bottom
	function addBottom()
	{				
		var selected = localStorage.getItem('selected_id_perlembagaan');

		var prevID = $("#"+selected).prev().attr('id');
	
		//If prev id == 'level'. Do nothing. 
		var arr = prevID.split('_');
		var val =  $.trim(arr[0]);
		if(val != 'level'){
			divSelected = $('#'+selected);
			divprev = $('#'+prevID);

			tdiv1 = divSelected.clone();
			tdiv2 = divprev.clone();

			divSelected.replaceWith(tdiv2);
			divprev.replaceWith(tdiv1);
		}
		$("div").qtip('hide');
		
		rewriteID();
	}
	
	//Add Top
	function addTop()
	{
		var selected = localStorage.getItem('selected_id_perlembagaan');
		var nextID = $("#"+selected).next().attr('id');
		
		divSelected = $('#'+selected);
		divNext = $('#'+nextID);

		tdiv1 = divSelected.clone();
		tdiv2 = divNext.clone();

		divSelected.replaceWith(tdiv2);
		divNext.replaceWith(tdiv1);
		$("div").qtip('hide');				

		rewriteID();
	}
	
	//Add Bottom
	function addFasal()
	{	
		var selected = localStorage.getItem('selected_id_perlembagaan');
		var levelID = $('#'+(selected)).children().attr('id');
		var selectedFasalTxtShow;
		
		var levelIDShow = levelID.replace('level_','');
		
		localStorage['fasal_index'] = (parseInt((selected).replace('tr_', ''))+1);
		localStorage['level_id'] = levelIDShow;
		
		//get current fasal & plus one
		if(levelIDShow < 2){
			var selectedFasalTxt = $('#'+(selected)+' .fasal_label').html();;
			selectedFasalTxtShow = 'Fasal'+(parseInt((selectedFasalTxt).replace('Fasal ', ''))+1);
		}
		else
		{
			var selectedFasalTxt = $('#'+(selected)+' .sub_fasal_label').html();;
			selectedFasalTxtShow = selectedFasalTxt;
		}
		
		$('.inform').remove();
		$('#'+selected).append("<div class='inform' id='added_"+selected+"'><table><tr><td width='90px'><input type='text' id='no_fasal_"+(selected+1)+"_added' placeholder='"+selectedFasalTxtShow+"' disabled></input></td><td width='10px'>&nbsp;</td><td><input type='text' id='fasal_added_"+selected+"'></input></td><td width='90px'><div class='okIcon' id='search' onclick='addDisplay();'></div></td></tr></table></div>");
		$("div").qtip('hide');				
		
	

	
		$('.fasal_label').each(function() {
			var span_id = this.id;
			var span_value = $('#'+span_id).html();
			var addOne = parseInt(span_value.replace('Fasal ',''));
			
			if(addOne > selected.replace('tr_', ''))
			{
				var afterAdd = parseInt(addOne+1);
				var fasal_index = 'Fasal '+afterAdd;
				$('#'+span_id).html(fasal_index);	
			}

		});
		
		var zz = 1;
		var zzz = 1;
		
		$('.fasal_label').each(function() {
			var tr_id = this.id;
			var arr = tr_id.split('_');
			var tr_value =  $.trim("fasal_index_"+arr[2]);
			
			$('#'+tr_value).attr('id','xxxxx_'+zz);
			zz = parseInt(zz+1);

		});

		$('.fasal_label').each(function() {
			$('#xxxxx_'+zzz).attr('id','fasal_index_'+zzz);
			zzz = parseInt(zzz+1);
		});
	}
	
	//Edit Fasal
	function editFasal()
	{				
		var selected = localStorage.getItem('selected_id_perlembagaan');
		var IDselected = selected.replace('tr_', '');
		var levelID = $('#'+(selected)).children().attr('id');
		var levelIDShow = levelID.replace('level_','');
		
		//get current fasal 
		if(levelIDShow < 2){
			var selectedFasalTxt = $('#'+(selected)+' .fasal_label').html();;
			selectedFasalTxtShow = selectedFasalTxt;
		}
		else
		{
			var selectedFasalTxt = $('#'+(selected)+' .sub_fasal_label').html();;
			selectedFasalTxtShow = selectedFasalTxt;
		}
		
		$('.inform').remove();
		
		$('#'+selected).append("<div class='inform' id='added_"+selected+"'><table><tr><td width='90px'><input type='text' id='no_fasal_"+(selected)+"_added' placeholder='"+selectedFasalTxtShow+"' disabled></input></td><td width='10px'>&nbsp;</td><td><input type='text' id='fasal_added_"+selected+"' value='"+$('#fasal_index_'+IDselected+'_text').text()+"'></input></td><td width='90px'><div class='okIcon' id='search' onclick='editDisplay();'></div></td></tr></table></div>");
		$("div").qtip('hide');
		
		/*FASAL LABEL INDEX*/
		var dummyFasalLabelIndex = 1;
	}
	
	function editDisplay()
	{
		var id = localStorage.getItem('selected_id_perlembagaan');
		var IDselected = id.replace('tr_', '');
		/*On click display - check if null*/
		if($('#fasal_added_'+(id)).val() != "")
		{
			var editedFasalText = $('#fasal_added_'+id).val();
			$('#fasal_index_'+IDselected+'_text').text(editedFasalText);
		}
		
		$('#added_'+id).remove();

	}

	
	function addDisplay()
	{			
		/*FASAL LABEL INDEX*/
		var dummyFasalLabelIndex = 1;
	
		var id = localStorage.getItem('selected_id_perlembagaan');
		var thisID = id;
		var fasal_index = localStorage.getItem('fasal_index');
		var appendId = 'tr_'+(parseInt((id).replace('tr_', ''))+1);
		
		/*SET MARGIN FOR EACH FASAL LEVEL*/
		var loopForMarginLeftValue = localStorage.getItem('level_id');
		var label_class;
		var label_text;
		
		if(loopForMarginLeftValue > 1)
		{
			label_class = 'sub_fasal_label';
			label_text = 'PerPuluhan';
			
		}
		else
		{
			label_class = 'fasal_label';
			label_text = 'Fasal '+ fasal_index;
		}
		var marginLeftPX = 0;
		for(var x = 1; x < loopForMarginLeftValue ; x++)
		{
			marginLeftPX = parseInt(marginLeftPX+30);
		}

		/*On click display - check if null*/
		if($('#fasal_added_'+(id)).val() != "")
		{
			var editorImgSecondLvl = '<image class="openToolTip" id="'+appendId+'_img" style="margin-bottom:-7px;" src="img/pindaan-icon.png" width="25px" height="25px" >';
			var checkBoxSecondLvl = '<input class="checkboxClass" id="checkbox'+id+'" type="checkbox" name="senarai" value="Maklumat Sijil Pendaftaran Pertubuhan Belia" /><label/>';
			$('<div class="checkbox" id="new_added_'+appendId+'" style="margin-left:'+marginLeftPX+'px;" ><div width="30px" class="xx" id="level_'+loopForMarginLeftValue+'">'+editorImgSecondLvl+' '+checkBoxSecondLvl+'<label id="fasal_added_'+(id+1)+'" for="checkbox'+id+'"><span class="'+label_class+'" id="fasal_index_'+appendId+'">'+label_text+'</span> - <span class="fasal_label_text" id="fasal_index_'+appendId.replace('tr_', '')+'_text"> '+$('#fasal_added_'+(id)).val()+'</span></label></div></div>').insertAfter($('#'+id));				
		}
		
		$('#added_'+id).remove();
		
		/*Differentiate between <tr>*/
		$('.checkbox').each(function() {
			
			var tr_id = this.id;
			var tr_value =  $('#'+tr_id).attr('id');
			var trAddOne = parseInt(tr_value.replace('tr_',''));

			if(trAddOne > id.replace('tr_',''))
			{
				var trAfterAdd = parseInt(trAddOne+1);
				$('#'+tr_id).attr('id','tr_'+trAfterAdd);
			}
		});
		
		$('#new_added_'+appendId).attr('id',appendId);
		
		rewriteID();
	}
	
	function rewriteID()
	{
		/* Re-write <TR NO> */
		var index = 1;
		var indexx = 1;

		$('.checkbox').each(function() {
			var tr_id = this.id;
			var tr_value =  $('#'+tr_id).attr('id');
			$('#'+tr_value).attr('id','xx_'+index);

			index = parseInt(index+1);
		});
		
		var indexx = 1;
		$('.checkbox').each(function() {
			$('#xx_'+indexx).attr('id','tr_'+indexx);
			indexx = parseInt(indexx+1);
		});
	

		/* Re-write <FASAL LABEL NO/ID> */
		var indexFasal = 1;
		var indexFasalR = 1;

		$('.fasal_label').each(function() {
				
			var tr_id = this.id;
			var tr_value =  $('#'+tr_id).attr('id');

			var arr = tr_value.split('_');
			var label_text_no = $.trim(arr[2]);

			$('#'+tr_value).attr('id','xxx_'+indexFasal);
			$('#fasal_index_'+label_text_no+'_text').attr('id','tmp_'+indexFasal);

	
			indexFasal = parseInt(indexFasal+1);

		});

		$('.fasal_label').each(function() {
			$('#xxx_'+indexFasalR).attr('id','fasal_index_'+indexFasalR);
			$('#tmp_'+indexFasalR).attr('id','fasal_index_'+indexFasalR+'_text');

			$('#fasal_index_'+indexFasalR).html('Fasal'+' '+indexFasalR);
			
			indexFasalR = parseInt(indexFasalR+1);
		});

		/// Fasal Label Text ///

		var indexFasalSS = 1;
		var indexFasalRSS = 1;

		$('.fasal_label_text').each(function() {
				
			var tr_id = this.id;
			var tr_value = tr_id.replace('tr_','')

			$('#'+tr_value).attr('id','tempxx_'+indexFasalSS);
	
			indexFasalSS = parseInt(indexFasalSS+1);

		});

		$('.fasal_label_text').each(function() {
			
			$('#tempxx_'+indexFasalRSS).attr('id','fasal_index_'+indexFasalRSS+'_text');			
			indexFasalRSS = parseInt(indexFasalRSS+1);

		});
		
		
		/* Re-write <Img ID> */
		var indexFasalXX = 1;
		var indexFasalRXX = 1;

		$('.openToolTip').each(function() {
			var tr_id = this.id;
			var arr = tr_id.split('_');
			var tr_value =  $.trim("tr_"+arr[1]);
			
			$('#'+tr_value+'_img').attr('id','xxx_'+indexFasalXX);
			indexFasalXX = parseInt(indexFasalXX+1);

		});

		$('.openToolTip').each(function() {
			$('#xxx_'+indexFasalRXX).attr('id','tr_'+indexFasalRXX+'_img');
			indexFasalRXX = parseInt(indexFasalRXX+1);
		});

	}

	</script>
	</body>
</html>